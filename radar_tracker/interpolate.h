#ifndef INTERPOLATE_H_
#define INTERPOLATE_H_

#include <iostream>
#include <vector>

static std::vector<double> lookup_x_deg = {-79.977678, -77.713955, -75.655318, -74.292469, -72.490363,
                                    -71.080826, -69.421694, -68.196046, -66.625817, -65.297553,
                                    -63.900670, -62.652433, -61.198385, -59.857317, -58.391745,
                                    -57.308927, -56.109970, -54.571795, -53.291133, -52.289671,
                                    -51.133968, -49.632513, -48.770120, -47.479892, -46.154894,
                                    -45.279368, -44.199169, -43.131885, -42.041240, -40.540094,
                                    -39.826200, -38.536101, -37.588292, -36.345276, -35.163502,
                                    -34.035568, -32.669369, -31.449356, -30.241382, -28.900743,
                                    -27.605052, -26.097095, -24.755827, -23.266772, -21.658331,
                                    -20.070380, -18.548962, -16.654135, -15.053504, -13.130063,
                                    -11.257596,  -9.627062,  -7.720555,  -5.586311,  -3.794606,
                                     -1.978887,   0.159338,   1.931518,   2.122638,   3.890035,
                                      5.538995,   7.397077,   9.301306,  10.949706,  12.515215,
                                     14.360962,  16.172754,  17.477723,  18.694802,  20.207085,
                                     21.568483,  22.932951,  24.230250,  25.619905,  27.010230,
                                     28.415684,  29.760073,  31.053209,  32.424234,  33.677896,
                                     34.969797,  36.259616,  37.506550,  38.814334,  40.093769,
                                     41.269190,  42.741108,  43.864469,  45.110838,  46.225542,
                                     47.485001,  48.533345,  49.914759,  51.028304,  52.170705,
                                     53.514216,  54.976435,  56.183556,  57.298362,  58.640811,
                                     59.562672,  60.894208,  61.954048,  62.813224,  64.339308,
                                     65.499413,  67.104983,  68.165950,  69.143996,  70.507424,
                                     72.030891,  73.467458,  74.734552,  76.902750,  77.934662,
                                     80.812894 };
                                 
static std::vector<double> lookup_y_deg = {-51.300000, -50.400000, -49.500000, -48.600000, -47.700000,
                                    -46.800000, -45.900000, -45.000000, -44.100000, -43.200000,
                                    -42.300000, -41.400000, -40.500000, -39.600000, -38.700000,
                                    -37.800000, -36.900000, -36.000000, -35.100000, -34.200000,
                                    -33.300000, -32.400000, -31.500000, -30.600000, -29.700000,
                                    -28.800000, -27.900000, -27.000000, -26.100000, -25.200000,
                                    -24.300000, -23.400000, -22.500000, -21.600000, -20.700000,
                                    -19.800000, -18.900000, -18.000000, -17.100000, -16.200000,
                                    -15.300000, -14.400000, -13.500000, -12.600000, -11.700000,
                                    -10.800000,  -9.900000,  -9.000000,  -8.100000,  -7.200000,
                                     -6.300000,  -5.400000,  -4.500000,  -3.600000,  -2.700000,
                                     -1.800000,  -0.900000,   0.000000,  -0.000000,   0.900000,
                                      1.800000,   2.700000,   3.600000,   4.500000,   5.400000,
                                      6.300000,   7.200000,   8.100000,   9.000000,   9.900000,
                                     10.800000,  11.700000,  12.600000,  13.500000,  14.400000,
                                     15.300000,  16.200000,  17.100000,  18.000000,  18.900000,
                                     19.800000,  20.700000,  21.600000,  22.500000,  23.400000,
                                     24.300000,  25.200000,  26.100000,  27.000000,  27.900000,
                                     28.800000,  29.700000,  30.600000,  31.500000,  32.400000,
                                     33.300000,  34.200000,  35.100000,  36.000000,  36.900000,
                                     37.800000,  38.700000,  39.600000,  40.500000,  41.400000,
                                     42.300000,  43.200000,  44.100000,  45.000000,  45.900000,
                                     46.800000,  47.700000,  48.600000,  49.500000,  50.400000,
                                     51.300000 };

static std::vector<double> lookup_x_rad = {-1.395874, -1.356364, -1.320434, -1.296648, -1.265196,
                                    -1.240594, -1.211637, -1.190246, -1.162840, -1.139657,
                                    -1.115277, -1.093491, -1.068113, -1.044707, -1.019128,
                                    -1.000229, -0.979304, -0.952457, -0.930106, -0.912627,
                                    -0.892456, -0.866251, -0.851199, -0.828680, -0.805555,
                                    -0.790274, -0.771421, -0.752793, -0.733758, -0.707558,
                                    -0.695098, -0.672582, -0.656039, -0.634345, -0.613719,
                                    -0.594033, -0.570188, -0.548895, -0.527812, -0.504413,
                                    -0.481799, -0.455480, -0.432071, -0.406082, -0.378009,
                                    -0.350294, -0.323740, -0.290669, -0.262733, -0.229163,
                                    -0.196482, -0.168024, -0.134749, -0.097500, -0.066228,
                                    -0.034538,  0.002781,  0.033711,  0.037047,  0.067894,
                                     0.096674,  0.129103,  0.162338,  0.191108,  0.218432,
                                     0.250646,  0.282268,  0.305044,  0.326286,  0.352680,
                                     0.376441,  0.400256,  0.422898,  0.447152,  0.471417,
                                     0.495947,  0.519411,  0.541981,  0.565910,  0.587790,
                                     0.610338,  0.632850,  0.654613,  0.677438,  0.699768,
                                     0.720283,  0.745973,  0.765579,  0.787333,  0.806788,
                                     0.828770,  0.847067,  0.871177,  0.890612,  0.910551,
                                     0.933999,  0.959520,  0.980588,  1.000045,  1.023475,
                                     1.039565,  1.062804,  1.081302,  1.096298,  1.122933,
                                     1.143180,  1.171203,  1.189720,  1.206790,  1.230587,
                                     1.257176,  1.282249,  1.304364,  1.342206,  1.360216,
                                     1.410451 };
                                    
static std::vector<double> lookup_y_rad = {-0.895354, -0.879646, -0.863938, -0.848230, -0.832522,
                                    -0.816814, -0.801106, -0.785398, -0.769690, -0.753982,
                                    -0.738274, -0.722566, -0.706858, -0.691150, -0.675442,
                                    -0.659734, -0.644026, -0.628319, -0.612611, -0.596903,
                                    -0.581195, -0.565487, -0.549779, -0.534071, -0.518363,
                                    -0.502655, -0.486947, -0.471239, -0.455531, -0.439823,
                                    -0.424115, -0.408407, -0.392699, -0.376991, -0.361283,
                                    -0.345575, -0.329867, -0.314159, -0.298451, -0.282743,
                                    -0.267035, -0.251327, -0.235619, -0.219911, -0.204204,
                                    -0.188496, -0.172788, -0.157080, -0.141372, -0.125664,
                                    -0.109956, -0.094248, -0.078540, -0.062832, -0.047124,
                                    -0.031416, -0.015708,  0.000000, -0.000000,  0.015708,
                                     0.031416,  0.047124,  0.062832,  0.078540,  0.094248,
                                     0.109956,  0.125664,  0.141372,  0.157080,  0.172788,
                                     0.188496,  0.204204,  0.219911,  0.235619,  0.251327,
                                     0.267035,  0.282743,  0.298451,  0.314159,  0.329867,
                                     0.345575,  0.361283,  0.376991,  0.392699,  0.408407,
                                     0.424115,  0.439823,  0.455531,  0.471239,  0.486947,
                                     0.502655,  0.518363,  0.534071,  0.549779,  0.565487,
                                     0.581195,  0.596903,  0.612611,  0.628319,  0.644026,
                                     0.659734,  0.675442,  0.691150,  0.706858,  0.722566,
                                     0.738274,  0.753982,  0.769690,  0.785398,  0.801106,
                                     0.816814,  0.832522,  0.848230,  0.863938,  0.879646,
                                     0.895354 };
                                     
                                     
double interpolate( double input )
{
    double output;
    double k;
    
    //limit range, no interpolation can be performed
    if( ( input < lookup_x_rad[0] )||( input > lookup_x_rad.back() ) )
    {
        //std::cout << "out of range" << std::endl;
        return 0;
    }
    
    for(int i = 0; i < lookup_x_rad.size(); ++i)
    {
        //perfect match found
        if( input == lookup_x_rad[i] )
        {
            output = lookup_y_rad[i];
            return output;
        }
        
        //interpolate between lookup_x_rad[i] and lookup_x_rad[i+1]
        if( ( lookup_x_rad[i] < input )&&( input < lookup_x_rad[i+1] ) )
        {
            k = ( lookup_y_rad[i+1]-lookup_y_rad[i] )/( lookup_x_rad[i+1]-lookup_x_rad[i] );
            
            output = lookup_y_rad[i] + k*( input-lookup_x_rad[i] );
            
            return output;
        }
    }
}

#endif
